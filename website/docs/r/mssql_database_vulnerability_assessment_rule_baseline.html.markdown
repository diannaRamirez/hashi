---
layout: "azurerm"
page_title: "Azure Resource Manager: azurerm_mssql_database_vulnerability_assessment_rule_baseline"
sidebar_current: "docs-azurerm-resource-database-vulnerability-assessment-rule-baseline-x"
description: |-
  Manages a Database Vulnerability Assessment Rule Baseline.

---

# azurerm_mssql_database_vulnerability_assessment_rule_baseline

Manages a Database Vulnerability Assessment Rule Baseline.

-> **NOTE** Database Vulnerability Assessment is currently only available for MS SQL databases.

## Example Usage

```hcl
resource "azurerm_resource_group" "example" {
  name     = "acceptanceTestResourceGroup1"
  location = "West US"
}

resource "azurerm_sql_server" "example" {
  name                         = "mysqlserver"
  resource_group_name          = "${azurerm_resource_group.example.name}"
  location                     = "${azurerm_resource_group.example.location}"
  version                      = "12.0"
  administrator_login          = "4dm1n157r470r"
  administrator_login_password = "4-v3ry-53cr37-p455w0rd"
}

resource "azurerm_storage_account" "example" {
  name                     = "accteststorageaccount"
  resource_group_name      = "${azurerm_resource_group.example.name}"
  location                 = "${azurerm_resource_group.example.location}"
  account_tier             = "Standard"
  account_replication_type = "GRS"
}

resource "azurerm_storage_container" "example" {
  name                  = "accteststoragecontainer"
  resource_group_name   = "${azurerm_resource_group.example.name}"
  storage_account_name  = "${azurerm_storage_account.example.name}"
  container_access_type = "private"
}

resource "azurerm_mssql_server_security_alert_policy" "example" {
  resource_group_name = azurerm_resource_group.example.name
  server_name         = azurerm_sql_server.example.name
  state               = "Enabled"
}

resource "azurerm_template_deployment" "vulnerability_scan_settings" {
  name                = "accteststoragevss"
  resource_group_name = "${azurerm_resource_group.example.name}"
  deployment_mode     = "Incremental"

  parameters = {
    "sqlServerName"      = "${azurerm_sql_server.example.name}"
    "storageAccountName" = "${azurerm_storage_account.example.name}"
    "blobContainerName"  = "${azurerm_storage_container.example.name}"
  }

  depends_on = [
    azurerm_sql_database.example,
    azurerm_mssql_server_security_alert_policy.example
  ]

  template_body = <<DEPLOY
{
  "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "sqlServerName": {
      "type": "string"
    },
    "storageAccountName": {
      "type": "string"
    },
    "blobContainerName": {
      "type": "string"
    }
  },
  "resources": [
    {
      "type": "Microsoft.Sql/servers/vulnerabilityAssessments",
      "name": "[concat(parameters('sqlServerName'), '/Default')]",
      "apiVersion": "2018-06-01-preview",
      "scale": null,
      "properties": {
        "storageContainerPath": "[concat('https', '://', parameters('storageAccountName'), '.blob.core.windows.net/', parameters('blobContainerName'), '/')]",
        "storageAccountAccessKey": "[listKeys(resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccountName')), providers('Microsoft.Storage', 'storageAccounts').apiVersions[0]).keys[0].value]"
      }
    }
  ]
}
DEPLOY
}

resource "azurerm_sql_database" "example" {
  name                = "mysqldatabase"
  resource_group_name = "${azurerm_resource_group.example.name}"
  server_name         = "${azurerm_sql_server.example.name}"
  location            = "${azurerm_resource_group.example.location}"
  edition             = "Standard"
}

resource "azurerm_mssql_database_vulnerability_assessment_rule_baseline" "example" {
  resource_group_name = "${azurerm_resource_group.example.name}"
  server_name         = "${azurerm_sql_server.example.name}"
  database_name       = "${azurerm_sql_database.example.name}"
  rule_id             = "VA2065"
  baseline_name       = "master"
  baseline_result {
    result = [
      "allowedip1",
      "123.123.123.123",
      "123.123.123.123"
    ]
  }
  baseline_result {
    result = [
      "allowedip2",
      "255.255.255.255",
      "255.255.255.255"
    ]
  }


  depends_on = [
    azurerm_template_deployment.vulnerability_scan_settings
  ]
}
```

## Argument Reference

The following arguments are supported:

* `resource_group_name` - (Required) The name of the resource group that contains the MS SQL Server. Changing this forces a new resource to be created.

* `server_name` - (Required) Specifies the name of the MS SQL Server. Changing this forces a new resource to be created.

* `database_name` - (Required) Specifies the name of the MS SQL Database. Changing this forces a new resource to be created.

* `rule_id` - (Required) The vulnerability assessment rule ID. Changing this forces a new resource to be created.
    
* `baseline_name` - (Optional) The name of the vulnerability assessment rule baseline. Valid options are `default` and `master`. `default` implies a baseline on a database level rule and `master` for server level rule. Defaults to `default`. Changing this forces a new resource to be created.

* `baseline_result` - (Required) List of nested baseline result definitions. Each baseline result contains the following properties:

  * `result` - (Required) A list representing a result of the baseline.


## Attributes Reference

The following attributes are exported:

* `id` - The ID of the Database Vulnerability Assessment Rule Baseline.

## Import

Database Vulnerability Assessment Rule Baseline can be imported using the `resource id`, e.g.

```shell
terraform import azurerm_mssql_database_vulnerability_assessment_rule_baseline.example  /subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/acceptanceTestResourceGroup1/providers/Microsoft.Sql/servers/mysqlserver/databases/mysqldatabase/vulnerabilityAssessments/Default/rules/VA2065/baselines/master 
```
